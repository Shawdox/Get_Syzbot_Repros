

<!doctype html>
<html>
<head>
	
	<link rel="stylesheet" href="/static/style.css"/>
	<script src="/static/common.js"></script>
	
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116117799-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() { dataLayer.push(arguments); }
			gtag('js', new Date());
			gtag('config', 'UA-116117799-1');
		</script>
	

	<title>possible deadlock in swake_up_one</title>
</head>
<body>
	
	<header id="topbar">
		<table class="position_table">
			<tr>
				<td>
					<h1><a href="/upstream">syzbot</a></h1>
				</td>
				<td class="namespace_td">
					<select class="namespace" onchange="window.location.href = '/' + this.value + '';">
						
							<option value="android-5-10" >Android 5.10</option>
							<option value="android-5-15" >Android 5.15</option>
							<option value="android-54" >Android 5.4</option>
							<option value="android-6-1" >Android 6.1</option>
							<option value="freebsd" >FreeBSD</option>
							<option value="upstream" selected="1">Linux</option>
							<option value="linux-5.15" >Linux 5.15</option>
							<option value="linux-6.1" >Linux 6.1</option>
							<option value="netbsd" >NetBSD</option>
							<option value="openbsd" >OpenBSD</option>
							<option value="gvisor" >gVisor</option></select>
				</td>
				<td class="search">
					
					
						<a href="https://syzkaller.appspot.com/_ah/conflogin?continue=https://syzkaller.appspot.com/bug%3Fextid%3Dc1571e01da4f845b858f">sign-in</a> |
					
					<a href="https://groups.google.com/forum/#!forum/syzkaller" target="_blank">mailing list</a> |
					<a href="https://github.com/google/syzkaller" target="_blank">source</a> |
					<a href="https://github.com/google/syzkaller/blob/master/docs/syzbot.md" target="_blank">docs</a>
				</td>
			</tr>
		</table>
		
		<div class="navigation">
			<div class="navigation_tab">
				<a href='/upstream'><span style="color:DeepPink;">üêû</span> Open [1655]</a>
			</div>

			
			<div class="navigation_tab">
				<a href='/upstream/subsystems'><span style="color:DeepPink;">‚â°</span> Subsystems</a>
			</div>
			

			<div class="navigation_tab">
				<a href='/upstream/fixed'><span style="color:ForestGreen;">üêû</span> Fixed [6082]</a>
			</div>

			<div class="navigation_tab" href='/upstream/invalid'>
				<a href='/upstream/invalid'><span style="color:RoyalBlue;">üêû</span> Invalid [15105]</a>
			</div>

			
			<div class="navigation_tab">
				<a href='/upstream/backports'><span style="color:ForestGreen;">‚¨á</span> Missing Backports [157]</a>
			</div>
			

			<div class="navigation_tab">
				<a href='/upstream/graph/crashes'><span style="color:ForestGreen;">‚â°</span> Crashes</a>
			</div>

			<div class="dropdown navigation_tab">
				<button class="dropbtn"><span style="color:DarkOrange;">üìà</span>Graphs</button>
				<div class="dropdown-content">
					<a class="navigation_tab"
						href='/upstream/graph/bugs'>Kernel&nbsp;Health</a>
					<a class="navigation_tab"
						href='/upstream/graph/found-bugs'>Bugs/Month</a>
					<a class="navigation_tab"
						href='/upstream/graph/lifetimes'>Bug&nbsp;Lifetimes</a>
					<a class="navigation_tab"
						href='/upstream/graph/fuzzing'>Fuzzing</a>
				</div>
			</div>

			
			<div class="dropdown navigation_tab">
				<button class="dropbtn"><span style="color:DarkOrange;">üìà</span>Coverage</button>
				<div class="dropdown-content">
					<a class="navigation_tab"
						href="/upstream/graph/coverage?period=quarter">Total</a>
					<a class="navigation_tab"
						href="/upstream/coverage?period=month">Repo&nbsp;Heatmap</a>
					
						<a class="navigation_tab"
							href="/upstream/coverage/subsystems?period=month">Subsystems&nbsp;Heatmap</a>
					
				</div>
			</div>
			
			
			<div class="navigation_tab navigation_right">
				<a href='mailto:syzkaller@googlegroups.com'><span style="color:ForestGreen;">üí¨</span> Send us feedback</a>
			</div>
			
		</div>
		
	</header>
	<br>


	<b>possible deadlock in swake_up_one</b><br><br>
	Status: <a href="https://groups.google.com/d/msgid/syzkaller-bugs/000000000000a2b48d061626b3ac%40google.com">fixed on 2024/05/22 23:36</a><br>
	
		
			Subsystems: 
				<span class="bug-label"><a href="/upstream/s/bpf">bpf</a></span>
				<span class="bug-label"><a href="/upstream/s/net">net</a></span>
		<br>
		
	<a href="https://github.com/google/syzkaller/blob/master/docs/syzbot.md#labels">[Documentation on labels]</a><br>
	
	
	Reported-by: syzbot&#43;c1571e01da4f845b858f@syzkaller.appspotmail.com<br>
	
		<b>Fix commit:</b> 

	<span class="mono">
		
			ff9105993240
		
		<a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ff91059932401894e6c86341915615c5eb0eca48">bpf, sockmap: Prevent lock inversion deadlock in map delete elem</a>
	</span>

<br>
		
	
	First crash: 328d, last: 326d<br>
	
	<div>
		
		
		<div class="bug-bisection-stop"></div>
	</div>

	
	<div class="collapsible collapsible-show">
		<div class="head">
			<span class="show-icon">&#9654;</span>
			<span class="hide-icon">&#9660;</span>
			<span>Discussions (1)</span>
		</div>
		<div class="content">
			
			
			

<table class="list_table">
	<thead>
	<tr>
		<th>Title</th>
		<th>Replies (including bot)</th>
		<th>Last reply</th>
	</tr>
	</thead>
	<tbody>
	
		<tr>
			<td><a href="https://lore.kernel.org/all/000000000000a2b48d061626b3ac@google.com/T/">[syzbot] [bpf?] [net?] possible deadlock in swake_up_one</a></td>
			<td class="stat">1 (2)</td>
			<td class="stat">2024/04/20 15:53</td>
		</tr>
	
	</tbody>
</table>


			
			
		</div>
	</div>
	
	<div class="collapsible collapsible-hide">
		<div class="head">
			<span class="show-icon">&#9654;</span>
			<span class="hide-icon">&#9660;</span>
			<span>Similar bugs (1)</span>
		</div>
		<div class="content">
			


<table class="list_table">
	
	<thead>
	<tr>
		
			<th><a onclick="return sortTable(this, 'Kernel', textSort)" href="#">Kernel</a></th>
		
		<th><a onclick="return sortTable(this, 'Title', textSort)" href="#">Title</a></th>
		<th><a onclick="return sortTable(this, 'Repro', reproSort)" href="#">Repro</a></th>
		<th><a onclick="return sortTable(this, 'Cause bisect', textSort)" href="#">Cause bisect</a></th>
		<th><a onclick="return sortTable(this, 'Fix bisect', textSort)" href="#">Fix bisect</a></th>
		<th><a onclick="return sortTable(this, 'Count', numSort)" href="#">Count</a></th>
		<th><a onclick="return sortTable(this, 'Last', timeSort)" href="#">Last</a></th>
		<th><a onclick="return sortTable(this, 'Reported', timeSort)" href="#">Reported</a></th>
		
		
		
			<th><a onclick="return sortTable(this, 'Patched', patchedSort)" href="#">Patched</a></th>
		
		
			<th><a onclick="return sortTable(this, 'Status', textSort)" href="#">Status</a></th>
		
		
	</tr>
	</thead>
	<tbody>
	
		<tr>
			<td>linux-6.1</td>
			<td class="title">
				<a href="/bug?extid=34095b452740cc91e76d">possible deadlock in swake_up_one</a>
			</td>
			<td class="stat">C</td>
			<td class="bisect_status"></td>
			<td class="bisect_status">done</td>
			<td class="stat ">1</td>
			<td class="stat">332d</td>
			<td class="stat">
				
					<a href="https://groups.google.com/d/msgid/syzkaller-lts-bugs/0000000000004abb520615879a94%40google.com">332d</a>
				
			</td>
			
			
			
				<td class="patched" title="bpf, sockmap: Prevent lock inversion deadlock in map delete elem">3/3</td>
			
			
				<td class="status">
					
						<a href="https://groups.google.com/d/msgid/syzkaller-lts-bugs/0000000000004abb520615879a94%40google.com">fixed on 2024/05/15 09:17</a>
					
				</td>
			
			
		</tr>
	
	</tbody>
</table>



			
			
			
			
		</div>
	</div>
	

	
	<br><b>Sample crash report:</b><br>
	<div id="crash_div"><pre>=====================================================
WARNING: HARDIRQ-safe -&gt; HARDIRQ-unsafe lock order detected
6.8.0-syzkaller-08951-gfe46a7dd189e #0 Not tainted
-----------------------------------------------------
rcu_exp_gp_kthr/18 [HC0[0]:SC0[2]:HE0:SE0] is trying to acquire:
ffff88802f1b4820 (&amp;htab-&gt;buckets[i].lock){+...}-{2:2}, at: spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
ffff88802f1b4820 (&amp;htab-&gt;buckets[i].lock){+...}-{2:2}, at: sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>

and this task is already holding:
ffffffff8d7bc598 (&amp;rcu_state.expedited_wq){-.-.}-{2:2}, at: finish_swait+0xc5/0x280 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n139'>kernel/sched/swait.c:139</a>
which would create a new lock dependency:
 (&amp;rcu_state.expedited_wq){-.-.}-{2:2} -&gt; (&amp;htab-&gt;buckets[i].lock){+...}-{2:2}

but this new dependency connects a HARDIRQ-irq-safe lock:
 (&amp;rcu_state.expedited_wq){-.-.}-{2:2}

... which became HARDIRQ-irq-safe at:
  lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
  lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
  __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n110'>include/linux/spinlock_api_smp.h:110</a> [inline]
  _raw_spin_lock_irqsave+0x3a/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
  swake_up_one+0x1a/0x1b0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n51'>kernel/sched/swait.c:51</a>
  csd_do_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n133'>kernel/smp.c:133</a> [inline]
  __flush_smp_call_function_queue+0x41f/0x8c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n542'>kernel/smp.c:542</a>
  __sysvec_call_function_single+0x8c/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n271'>arch/x86/kernel/smp.c:271</a>
  instr_sysvec_call_function_single <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n266'>arch/x86/kernel/smp.c:266</a> [inline]
  sysvec_call_function_single+0x90/0xb0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n266'>arch/x86/kernel/smp.c:266</a>
  asm_sysvec_call_function_single+0x1a/0x20 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/idtentry.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n709'>arch/x86/include/asm/idtentry.h:709</a>
  trace_event_eval_update+0x1de/0xfe0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace_events.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2916'>kernel/trace/trace_events.c:2916</a>
  trace_insert_eval_map <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n6294'>kernel/trace/trace.c:6294</a> [inline]
  eval_map_work_func+0x3d/0x50 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n10069'>kernel/trace/trace.c:10069</a>
  process_one_work+0x9a9/0x1a60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3254'>kernel/workqueue.c:3254</a>
  process_scheduled_works <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3335'>kernel/workqueue.c:3335</a> [inline]
  worker_thread+0x6c8/0xf70 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3416'>kernel/workqueue.c:3416</a>
  kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
  ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
  ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>

to a HARDIRQ-irq-unsafe lock:
 (&amp;htab-&gt;buckets[i].lock){+...}-{2:2}

... which became HARDIRQ-irq-unsafe at:
...
  lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
  lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
  __raw_spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n126'>include/linux/spinlock_api_smp.h:126</a> [inline]
  _raw_spin_lock_bh+0x33/0x40 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n178'>kernel/locking/spinlock.c:178</a>
  spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
  sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>
  ___bpf_prog_run+0x3e51/0xae80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1997'>kernel/bpf/core.c:1997</a>
  __bpf_prog_run32+0xc1/0x100 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2236'>kernel/bpf/core.c:2236</a>
  bpf_dispatcher_nop_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1234'>include/linux/bpf.h:1234</a> [inline]
  __bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n657'>include/linux/filter.h:657</a> [inline]
  bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n664'>include/linux/filter.h:664</a> [inline]
  __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2381'>kernel/trace/bpf_trace.c:2381</a> [inline]
  bpf_trace_run2+0x151/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>
  __bpf_trace_contention_end+0xca/0x110 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
  trace_contention_end+0xce/0x120 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
  __mutex_lock_common <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n617'>kernel/locking/mutex.c:617</a> [inline]
  __mutex_lock+0x19c/0x9c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n752'>kernel/locking/mutex.c:752</a>
  futex_cleanup_begin <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1091'>kernel/futex/core.c:1091</a> [inline]
  futex_exit_release+0x2a/0x220 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1143'>kernel/futex/core.c:1143</a>
  exit_mm_release+0x19/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/fork.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1652'>kernel/fork.c:1652</a>
  exit_mm <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n542'>kernel/exit.c:542</a> [inline]
  do_exit+0x865/0x2be0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n865'>kernel/exit.c:865</a>
  do_group_exit+0xd3/0x2a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1027'>kernel/exit.c:1027</a>
  __do_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1038'>kernel/exit.c:1038</a> [inline]
  __se_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a> [inline]
  __x64_sys_exit_group+0x3e/0x50 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a>
  do_syscall_x64 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n52'>arch/x86/entry/common.c:52</a> [inline]
  do_syscall_64+0xd2/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n83'>arch/x86/entry/common.c:83</a>
  entry_SYSCALL_64_after_hwframe+0x6d/0x75

other info that might help us debug this:

 Possible interrupt unsafe locking scenario:

       CPU0                    CPU1
       ----                    ----
  lock(&amp;htab-&gt;buckets[i].lock);
                               local_irq_disable();
                               lock(&amp;rcu_state.expedited_wq);
                               lock(&amp;htab-&gt;buckets[i].lock);
  &lt;Interrupt&gt;
    lock(&amp;rcu_state.expedited_wq);

 *** DEADLOCK ***

2 locks held by rcu_exp_gp_kthr/18:
 #0: ffffffff8d7bc598 (&amp;rcu_state.expedited_wq){-.-.}-{2:2}, at: finish_swait+0xc5/0x280 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n139'>kernel/sched/swait.c:139</a>
 #1: ffffffff8d7b08e0 (rcu_read_lock){....}-{1:2}, at: rcu_lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/rcupdate.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n298'>include/linux/rcupdate.h:298</a> [inline]
 #1: ffffffff8d7b08e0 (rcu_read_lock){....}-{1:2}, at: rcu_read_lock <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/rcupdate.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n750'>include/linux/rcupdate.h:750</a> [inline]
 #1: ffffffff8d7b08e0 (rcu_read_lock){....}-{1:2}, at: __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2380'>kernel/trace/bpf_trace.c:2380</a> [inline]
 #1: ffffffff8d7b08e0 (rcu_read_lock){....}-{1:2}, at: bpf_trace_run2+0xe4/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>

the dependencies between HARDIRQ-irq-safe lock and the holding lock:
-&gt; (&amp;rcu_state.expedited_wq){-.-.}-{2:2} {
   IN-HARDIRQ-W at:
                    lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
                    lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
                    __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n110'>include/linux/spinlock_api_smp.h:110</a> [inline]
                    _raw_spin_lock_irqsave+0x3a/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
                    swake_up_one+0x1a/0x1b0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n51'>kernel/sched/swait.c:51</a>
                    csd_do_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n133'>kernel/smp.c:133</a> [inline]
                    __flush_smp_call_function_queue+0x41f/0x8c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n542'>kernel/smp.c:542</a>
                    __sysvec_call_function_single+0x8c/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n271'>arch/x86/kernel/smp.c:271</a>
                    instr_sysvec_call_function_single <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n266'>arch/x86/kernel/smp.c:266</a> [inline]
                    sysvec_call_function_single+0x90/0xb0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/smp.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n266'>arch/x86/kernel/smp.c:266</a>
                    asm_sysvec_call_function_single+0x1a/0x20 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/idtentry.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n709'>arch/x86/include/asm/idtentry.h:709</a>
                    trace_event_eval_update+0x1de/0xfe0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace_events.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2916'>kernel/trace/trace_events.c:2916</a>
                    trace_insert_eval_map <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n6294'>kernel/trace/trace.c:6294</a> [inline]
                    eval_map_work_func+0x3d/0x50 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n10069'>kernel/trace/trace.c:10069</a>
                    process_one_work+0x9a9/0x1a60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3254'>kernel/workqueue.c:3254</a>
                    process_scheduled_works <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3335'>kernel/workqueue.c:3335</a> [inline]
                    worker_thread+0x6c8/0xf70 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3416'>kernel/workqueue.c:3416</a>
                    kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
                    ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
                    ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>
   IN-SOFTIRQ-W at:
                    lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
                    lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
                    __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n110'>include/linux/spinlock_api_smp.h:110</a> [inline]
                    _raw_spin_lock_irqsave+0x3a/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
                    swake_up_one+0x1a/0x1b0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n51'>kernel/sched/swait.c:51</a>
                    rcu_report_exp_rdp <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n260'>kernel/rcu/tree_exp.h:260</a> [inline]
                    rcu_preempt_deferred_qs_irqrestore+0x592/0xb80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_plugin.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n506'>kernel/rcu/tree_plugin.h:506</a>
                    rcu_softirq_qs+0x1b/0x1c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n246'>kernel/rcu/tree.c:246</a>
                    __do_softirq+0x71a/0x8de <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/softirq.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n568'>kernel/softirq.c:568</a>
                    run_ksoftirqd <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/softirq.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n924'>kernel/softirq.c:924</a> [inline]
                    run_ksoftirqd+0x35/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/softirq.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n916'>kernel/softirq.c:916</a>
                    smpboot_thread_fn+0x661/0xa10 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/smpboot.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n164'>kernel/smpboot.c:164</a>
                    kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
                    ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
                    ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>
   INITIAL USE at:
                   lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
                   lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
                   __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n110'>include/linux/spinlock_api_smp.h:110</a> [inline]
                   _raw_spin_lock_irqsave+0x3a/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
                   prepare_to_swait_event+0x1f/0x470 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n107'>kernel/sched/swait.c:107</a>
                   synchronize_rcu_expedited_wait_once <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n516'>kernel/rcu/tree_exp.h:516</a> [inline]
                   synchronize_rcu_expedited_wait <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n570'>kernel/rcu/tree_exp.h:570</a> [inline]
                   rcu_exp_wait_wake+0x2a2/0x15e0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n641'>kernel/rcu/tree_exp.h:641</a>
                   kthread_worker_fn+0x305/0xab0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n841'>kernel/kthread.c:841</a>
                   kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
                   ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
                   ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>
 }
 ... key      at: [&lt;ffffffff946869c0&gt;] __key.3+0x0/0x40

the dependencies between the lock to be acquired
 and HARDIRQ-irq-unsafe lock:
-&gt; (&amp;htab-&gt;buckets[i].lock){+...}-{2:2} {
   HARDIRQ-ON-W at:
                    lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
                    lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
                    __raw_spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n126'>include/linux/spinlock_api_smp.h:126</a> [inline]
                    _raw_spin_lock_bh+0x33/0x40 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n178'>kernel/locking/spinlock.c:178</a>
                    spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
                    sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>
                    ___bpf_prog_run+0x3e51/0xae80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1997'>kernel/bpf/core.c:1997</a>
                    __bpf_prog_run32+0xc1/0x100 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2236'>kernel/bpf/core.c:2236</a>
                    bpf_dispatcher_nop_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1234'>include/linux/bpf.h:1234</a> [inline]
                    __bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n657'>include/linux/filter.h:657</a> [inline]
                    bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n664'>include/linux/filter.h:664</a> [inline]
                    __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2381'>kernel/trace/bpf_trace.c:2381</a> [inline]
                    bpf_trace_run2+0x151/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>
                    __bpf_trace_contention_end+0xca/0x110 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
                    trace_contention_end+0xce/0x120 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
                    __mutex_lock_common <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n617'>kernel/locking/mutex.c:617</a> [inline]
                    __mutex_lock+0x19c/0x9c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n752'>kernel/locking/mutex.c:752</a>
                    futex_cleanup_begin <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1091'>kernel/futex/core.c:1091</a> [inline]
                    futex_exit_release+0x2a/0x220 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1143'>kernel/futex/core.c:1143</a>
                    exit_mm_release+0x19/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/fork.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1652'>kernel/fork.c:1652</a>
                    exit_mm <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n542'>kernel/exit.c:542</a> [inline]
                    do_exit+0x865/0x2be0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n865'>kernel/exit.c:865</a>
                    do_group_exit+0xd3/0x2a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1027'>kernel/exit.c:1027</a>
                    __do_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1038'>kernel/exit.c:1038</a> [inline]
                    __se_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a> [inline]
                    __x64_sys_exit_group+0x3e/0x50 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a>
                    do_syscall_x64 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n52'>arch/x86/entry/common.c:52</a> [inline]
                    do_syscall_64+0xd2/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n83'>arch/x86/entry/common.c:83</a>
                    entry_SYSCALL_64_after_hwframe+0x6d/0x75
   INITIAL USE at:
                   lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
                   lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
                   __raw_spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n126'>include/linux/spinlock_api_smp.h:126</a> [inline]
                   _raw_spin_lock_bh+0x33/0x40 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n178'>kernel/locking/spinlock.c:178</a>
                   spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
                   sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>
                   ___bpf_prog_run+0x3e51/0xae80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1997'>kernel/bpf/core.c:1997</a>
                   __bpf_prog_run32+0xc1/0x100 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2236'>kernel/bpf/core.c:2236</a>
                   bpf_dispatcher_nop_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1234'>include/linux/bpf.h:1234</a> [inline]
                   __bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n657'>include/linux/filter.h:657</a> [inline]
                   bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n664'>include/linux/filter.h:664</a> [inline]
                   __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2381'>kernel/trace/bpf_trace.c:2381</a> [inline]
                   bpf_trace_run2+0x151/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>
                   __bpf_trace_contention_end+0xca/0x110 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
                   trace_contention_end+0xce/0x120 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
                   __mutex_lock_common <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n617'>kernel/locking/mutex.c:617</a> [inline]
                   __mutex_lock+0x19c/0x9c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/mutex.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n752'>kernel/locking/mutex.c:752</a>
                   futex_cleanup_begin <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1091'>kernel/futex/core.c:1091</a> [inline]
                   futex_exit_release+0x2a/0x220 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/futex/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1143'>kernel/futex/core.c:1143</a>
                   exit_mm_release+0x19/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/fork.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1652'>kernel/fork.c:1652</a>
                   exit_mm <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n542'>kernel/exit.c:542</a> [inline]
                   do_exit+0x865/0x2be0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n865'>kernel/exit.c:865</a>
                   do_group_exit+0xd3/0x2a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1027'>kernel/exit.c:1027</a>
                   __do_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1038'>kernel/exit.c:1038</a> [inline]
                   __se_sys_exit_group <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a> [inline]
                   __x64_sys_exit_group+0x3e/0x50 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/exit.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1036'>kernel/exit.c:1036</a>
                   do_syscall_x64 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n52'>arch/x86/entry/common.c:52</a> [inline]
                   do_syscall_64+0xd2/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/common.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n83'>arch/x86/entry/common.c:83</a>
                   entry_SYSCALL_64_after_hwframe+0x6d/0x75
 }
 ... key      at: [&lt;ffffffff949c67c0&gt;] __key.0+0x0/0x40
 ... acquired at:
   lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
   lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
   __raw_spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n126'>include/linux/spinlock_api_smp.h:126</a> [inline]
   _raw_spin_lock_bh+0x33/0x40 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n178'>kernel/locking/spinlock.c:178</a>
   spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
   sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>
   ___bpf_prog_run+0x3e51/0xae80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1997'>kernel/bpf/core.c:1997</a>
   __bpf_prog_run32+0xc1/0x100 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2236'>kernel/bpf/core.c:2236</a>
   bpf_dispatcher_nop_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1234'>include/linux/bpf.h:1234</a> [inline]
   __bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n657'>include/linux/filter.h:657</a> [inline]
   bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n664'>include/linux/filter.h:664</a> [inline]
   __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2381'>kernel/trace/bpf_trace.c:2381</a> [inline]
   bpf_trace_run2+0x151/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>
   __bpf_trace_contention_end+0xca/0x110 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
   trace_contention_end.constprop.0+0xe2/0x140 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
   __pv_queued_spin_lock_slowpath+0x266/0xc80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/qspinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n560'>kernel/locking/qspinlock.c:560</a>
   pv_queued_spin_lock_slowpath <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/paravirt.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n584'>arch/x86/include/asm/paravirt.h:584</a> [inline]
   queued_spin_lock_slowpath <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/qspinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n51'>arch/x86/include/asm/qspinlock.h:51</a> [inline]
   queued_spin_lock <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/asm-generic/qspinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n114'>include/asm-generic/qspinlock.h:114</a> [inline]
   do_raw_spin_lock+0x210/0x2c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock_debug.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n116'>kernel/locking/spinlock_debug.c:116</a>
   __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n111'>include/linux/spinlock_api_smp.h:111</a> [inline]
   _raw_spin_lock_irqsave+0x42/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
   finish_swait+0xc5/0x280 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n139'>kernel/sched/swait.c:139</a>
   synchronize_rcu_expedited_wait_once <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n516'>kernel/rcu/tree_exp.h:516</a> [inline]
   synchronize_rcu_expedited_wait <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n570'>kernel/rcu/tree_exp.h:570</a> [inline]
   rcu_exp_wait_wake+0x2db/0x15e0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n641'>kernel/rcu/tree_exp.h:641</a>
   kthread_worker_fn+0x305/0xab0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n841'>kernel/kthread.c:841</a>
   kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
   ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
   ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>


stack backtrace:
CPU: 1 PID: 18 Comm: rcu_exp_gp_kthr Not tainted 6.8.0-syzkaller-08951-gfe46a7dd189e #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024
Call Trace:
 &lt;TASK&gt;
 __dump_stack <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/lib/dump_stack.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n88'>lib/dump_stack.c:88</a> [inline]
 dump_stack_lvl+0x116/0x1f0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/lib/dump_stack.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n114'>lib/dump_stack.c:114</a>
 print_bad_irq_dependency <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2626'>kernel/locking/lockdep.c:2626</a> [inline]
 check_irq_usage+0xe3c/0x1490 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2865'>kernel/locking/lockdep.c:2865</a>
 check_prev_add <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3138'>kernel/locking/lockdep.c:3138</a> [inline]
 check_prevs_add <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3253'>kernel/locking/lockdep.c:3253</a> [inline]
 validate_chain <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n3869'>kernel/locking/lockdep.c:3869</a> [inline]
 __lock_acquire+0x248e/0x3b30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5137'>kernel/locking/lockdep.c:5137</a>
 lock_acquire <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5754'>kernel/locking/lockdep.c:5754</a> [inline]
 lock_acquire+0x1b1/0x540 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/lockdep.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n5719'>kernel/locking/lockdep.c:5719</a>
 __raw_spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n126'>include/linux/spinlock_api_smp.h:126</a> [inline]
 _raw_spin_lock_bh+0x33/0x40 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n178'>kernel/locking/spinlock.c:178</a>
 spin_lock_bh <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n356'>include/linux/spinlock.h:356</a> [inline]
 sock_hash_delete_elem+0xcb/0x260 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/core/sock_map.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n939'>net/core/sock_map.c:939</a>
 ___bpf_prog_run+0x3e51/0xae80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1997'>kernel/bpf/core.c:1997</a>
 __bpf_prog_run32+0xc1/0x100 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/core.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2236'>kernel/bpf/core.c:2236</a>
 bpf_dispatcher_nop_func <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/bpf.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n1234'>include/linux/bpf.h:1234</a> [inline]
 __bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n657'>include/linux/filter.h:657</a> [inline]
 bpf_prog_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/filter.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n664'>include/linux/filter.h:664</a> [inline]
 __bpf_trace_run <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2381'>kernel/trace/bpf_trace.c:2381</a> [inline]
 bpf_trace_run2+0x151/0x420 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/trace/bpf_trace.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n2420'>kernel/trace/bpf_trace.c:2420</a>
 __bpf_trace_contention_end+0xca/0x110 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
 trace_contention_end.constprop.0+0xe2/0x140 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/trace/events/lock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n122'>include/trace/events/lock.h:122</a>
 __pv_queued_spin_lock_slowpath+0x266/0xc80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/qspinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n560'>kernel/locking/qspinlock.c:560</a>
 pv_queued_spin_lock_slowpath <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/paravirt.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n584'>arch/x86/include/asm/paravirt.h:584</a> [inline]
 queued_spin_lock_slowpath <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/include/asm/qspinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n51'>arch/x86/include/asm/qspinlock.h:51</a> [inline]
 queued_spin_lock <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/asm-generic/qspinlock.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n114'>include/asm-generic/qspinlock.h:114</a> [inline]
 do_raw_spin_lock+0x210/0x2c0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock_debug.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n116'>kernel/locking/spinlock_debug.c:116</a>
 __raw_spin_lock_irqsave <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n111'>include/linux/spinlock_api_smp.h:111</a> [inline]
 _raw_spin_lock_irqsave+0x42/0x60 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n162'>kernel/locking/spinlock.c:162</a>
 finish_swait+0xc5/0x280 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/sched/swait.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n139'>kernel/sched/swait.c:139</a>
 synchronize_rcu_expedited_wait_once <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n516'>kernel/rcu/tree_exp.h:516</a> [inline]
 synchronize_rcu_expedited_wait <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n570'>kernel/rcu/tree_exp.h:570</a> [inline]
 rcu_exp_wait_wake+0x2db/0x15e0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n641'>kernel/rcu/tree_exp.h:641</a>
 kthread_worker_fn+0x305/0xab0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n841'>kernel/kthread.c:841</a>
 kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
 ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
 ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>
 &lt;/TASK&gt;
------------[ cut here ]------------
raw_local_irq_restore() called with IRQs enabled
WARNING: CPU: 1 PID: 18 at <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/irqflag-debug.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n10'>kernel/locking/irqflag-debug.c:10</a> warn_bogus_irq_restore+0x29/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/irqflag-debug.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n10'>kernel/locking/irqflag-debug.c:10</a>
Modules linked in:
CPU: 1 PID: 18 Comm: rcu_exp_gp_kthr Not tainted 6.8.0-syzkaller-08951-gfe46a7dd189e #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024
RIP: 0010:warn_bogus_irq_restore+0x29/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/irqflag-debug.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n10'>kernel/locking/irqflag-debug.c:10</a>
Code: 90 f3 0f 1e fa 90 80 3d 72 d0 b5 04 00 74 06 90 c3 cc cc cc cc c6 05 63 d0 b5 04 01 90 48 c7 c7 c0 b1 0c 8b e8 78 6b 7d f6 90 &lt;0f&gt; 0b 90 90 eb df 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
RSP: 0018:ffffc90000177d38 EFLAGS: 00010286
RAX: 0000000000000000 RBX: ffffffff8d7bc580 RCX: ffffffff814fafe9
RDX: ffff888016ef9e00 RSI: ffffffff814faff6 RDI: 0000000000000001
RBP: 0000000000000283 R08: 0000000000000001 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000a42
R13: ffffffff8f9e7034 R14: 0000000000000000 R15: dffffc0000000000
FS:  0000000000000000(0000) GS:ffff8880b9500000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000055558bbfdca8 CR3: 000000000d57a000 CR4: 00000000003506f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
 &lt;TASK&gt;
 __raw_spin_unlock_irqrestore <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/spinlock_api_smp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n151'>include/linux/spinlock_api_smp.h:151</a> [inline]
 _raw_spin_unlock_irqrestore+0x74/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/locking/spinlock.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n194'>kernel/locking/spinlock.c:194</a>
 synchronize_rcu_expedited_wait_once <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n516'>kernel/rcu/tree_exp.h:516</a> [inline]
 synchronize_rcu_expedited_wait <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n570'>kernel/rcu/tree_exp.h:570</a> [inline]
 rcu_exp_wait_wake+0x2db/0x15e0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/rcu/tree_exp.h?id=fe46a7dd189e25604716c03576d05ac8a5209743#n641'>kernel/rcu/tree_exp.h:641</a>
 kthread_worker_fn+0x305/0xab0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n841'>kernel/kthread.c:841</a>
 kthread+0x2c1/0x3a0 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/kthread.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n388'>kernel/kthread.c:388</a>
 ret_from_fork+0x45/0x80 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/kernel/process.c?id=fe46a7dd189e25604716c03576d05ac8a5209743#n147'>arch/x86/kernel/process.c:147</a>
 ret_from_fork_asm+0x1a/0x30 <a href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/x86/entry/entry_64.S?id=fe46a7dd189e25604716c03576d05ac8a5209743#n243'>arch/x86/entry/entry_64.S:243</a>
 &lt;/TASK&gt;
</pre></div><br>
	

	

<table class="list_table">
	<caption>Crashes (4):</caption>
		<thead>
		<tr>
			<th><a onclick="return sortTable(this, 'Time', textSort, true)" href="#">Time</a></th>
			<th><a onclick="return sortTable(this, 'Kernel', textSort)" href="#">Kernel</a></th>
			<th><a onclick="return sortTable(this, 'Commit', textSort)" href="#">Commit</a></th>
			<th><a onclick="return sortTable(this, 'Syzkaller', textSort)" href="#">Syzkaller</a></th>
			<th><a onclick="return sortTable(this, 'Config', textSort)" href="#">Config</a></th>
			<th><a onclick="return sortTable(this, 'Log', textSort)" href="#">Log</a></th>
			<th><a onclick="return sortTable(this, 'Report', reproSort)" href="#">Report</a></th>
			<th><a onclick="return sortTable(this, 'Syz repro', reproSort)" href="#">Syz repro</a></th>
			<th><a onclick="return sortTable(this, 'C repro', textSort)" href="#">C repro</a></th>
			<th><a onclick="return sortTable(this, 'VM info', textSort)" href="#">VM info</a></th>
			<th><a onclick="return sortTable(this, 'Assets', textSort)" href="#">Assets</a> (<a href="https://github.com/google/syzkaller/blob/master/docs/syzbot_assets.md">help?</a>)</th>
			<th><a onclick="return sortTable(this, 'Manager', textSort)" href="#">Manager</a></th>
			<th><a onclick="return sortTable(this, 'Title', textSort)" href="#">Title</a></th>
		</tr>
		</thead>
		<tbody>
		
		<tr>
			<td class="time">2024/04/13 09:14</td>
			<td class="kernel" title="upstream">upstream</td>
			<td class="tag" title="fe46a7dd189e25604716c03576d05ac8a5209743
	2024/03/14 18:10"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/?id=fe46a7dd189e25604716c03576d05ac8a5209743">fe46a7dd189e</a></td>
			<td class="tag"><a href="https://github.com/google/syzkaller/commits/c8349e48534ea6d8f01515335d95de8ebf5da8df">c8349e48</a></td>
			<td class="config"><a href="/text?tag=KernelConfig&amp;x=aef2a55903e5791c">.config</a></td>
			<td class="repro"><a href="/text?tag=CrashLog&amp;x=1683dbcb180000">console log</a></td>
			<td class="repro"><a href="/text?tag=CrashReport&amp;x=1481a7cb180000">report</a></td>
			<td class="repro">
				<a href="/text?tag=ReproSyz&amp;x=10698467180000">syz</a>
				
			</td>
			<td class="repro"><a href="/text?tag=ReproC&amp;x=16c80f4d180000">C</a></td>
			<td class="repro"></td>
			<td class="assets">
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/089e25869df5/disk-fe46a7dd.raw.xz">disk image</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/423b1787914f/vmlinux-fe46a7dd.xz">vmlinux</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/4c043e30c07d/bzImage-fe46a7dd.xz">kernel image</a>]</span>
			</td>
			<td class="manager">ci-upstream-kasan-gce-selinux-root</td>
			<td class="manager">possible deadlock in swake_up_one</td>
		</tr>
		
		<tr>
			<td class="time">2024/04/14 10:28</td>
			<td class="kernel" title="net">net</td>
			<td class="tag" title="f99c5f563c174a49ea1cbf4754539b05cfde40c4
	2024/03/21 14:16"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/log/?id=f99c5f563c174a49ea1cbf4754539b05cfde40c4">f99c5f563c17</a></td>
			<td class="tag"><a href="https://github.com/google/syzkaller/commits/c8349e48534ea6d8f01515335d95de8ebf5da8df">c8349e48</a></td>
			<td class="config"><a href="/text?tag=KernelConfig&amp;x=6fb1be60a193d440">.config</a></td>
			<td class="repro"><a href="/text?tag=CrashLog&amp;x=161f1db7180000">console log</a></td>
			<td class="repro"><a href="/text?tag=CrashReport&amp;x=11ef9f4d180000">report</a></td>
			<td class="repro">
				<a href="/text?tag=ReproSyz&amp;x=103b0f7b180000">syz</a>
				
			</td>
			<td class="repro"><a href="/text?tag=ReproC&amp;x=1103cecd180000">C</a></td>
			<td class="repro"></td>
			<td class="assets">
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/65d3f3eb786e/disk-f99c5f56.raw.xz">disk image</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/799cf7f28ff8/vmlinux-f99c5f56.xz">vmlinux</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/ab26c60c3845/bzImage-f99c5f56.xz">kernel image</a>]</span>
			</td>
			<td class="manager">ci-upstream-net-this-kasan-gce</td>
			<td class="manager">possible deadlock in swake_up_one</td>
		</tr>
		
		<tr>
			<td class="time">2024/04/13 07:42</td>
			<td class="kernel" title="upstream">upstream</td>
			<td class="tag" title="fe46a7dd189e25604716c03576d05ac8a5209743
	2024/03/14 18:10"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/?id=fe46a7dd189e25604716c03576d05ac8a5209743">fe46a7dd189e</a></td>
			<td class="tag"><a href="https://github.com/google/syzkaller/commits/c8349e48534ea6d8f01515335d95de8ebf5da8df">c8349e48</a></td>
			<td class="config"><a href="/text?tag=KernelConfig&amp;x=aef2a55903e5791c">.config</a></td>
			<td class="repro"><a href="/text?tag=CrashLog&amp;x=14eedeeb180000">console log</a></td>
			<td class="repro"><a href="/text?tag=CrashReport&amp;x=172032db180000">report</a></td>
			<td class="repro">
				
				
			</td>
			<td class="repro"></td>
			<td class="repro"><a href="/text?tag=MachineInfo&amp;x=3ff853db3eb234f8">info</a></td>
			<td class="assets">
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/089e25869df5/disk-fe46a7dd.raw.xz">disk image</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/423b1787914f/vmlinux-fe46a7dd.xz">vmlinux</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/4c043e30c07d/bzImage-fe46a7dd.xz">kernel image</a>]</span>
			</td>
			<td class="manager">ci-upstream-kasan-gce-selinux-root</td>
			<td class="manager">possible deadlock in swake_up_one</td>
		</tr>
		
		<tr>
			<td class="time">2024/04/11 18:09</td>
			<td class="kernel" title="bpf">bpf</td>
			<td class="tag" title="443574b033876c85a35de4c65c14f7fe092222b2
	2024/03/25 18:39"><a href="https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/log/?id=443574b033876c85a35de4c65c14f7fe092222b2">443574b03387</a></td>
			<td class="tag"><a href="https://github.com/google/syzkaller/commits/478efa7f2f5af720ac23b860a65d458f3db39b0c">478efa7f</a></td>
			<td class="config"><a href="/text?tag=KernelConfig&amp;x=6fb1be60a193d440">.config</a></td>
			<td class="repro"><a href="/text?tag=CrashLog&amp;x=167b4cf5180000">console log</a></td>
			<td class="repro"><a href="/text?tag=CrashReport&amp;x=125c68db180000">report</a></td>
			<td class="repro">
				
				
			</td>
			<td class="repro"></td>
			<td class="repro"><a href="/text?tag=MachineInfo&amp;x=119f5312325096d3">info</a></td>
			<td class="assets">
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/3f355021a085/disk-443574b0.raw.xz">disk image</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/44cf4de7472a/vmlinux-443574b0.xz">vmlinux</a>]</span>
			
				<span class="no-break">[<a href="https://storage.googleapis.com/syzbot-assets/a99a36c7ad65/bzImage-443574b0.xz">kernel image</a>]</span>
			</td>
			<td class="manager">ci-upstream-bpf-kasan-gce</td>
			<td class="manager">possible deadlock in swake_up_one</td>
		</tr>
		
		</tbody>
</table>
<i>* <s>Struck through</s> repros no longer work on HEAD.</i>


</body>
</html>
