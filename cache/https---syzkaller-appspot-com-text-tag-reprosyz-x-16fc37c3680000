# https://syzkaller.appspot.com/bug?id=a00a44550a20a20a8ea8209f9bb47476d51be1ba
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"repeat":true,"procs":6,"slowdown":1,"sandbox":"none","sandbox_arg":0,"tun":true,"netdev":true,"resetnet":true,"cgroups":true,"binfmt_misc":true,"close_fds":true,"usb":true,"vhci":true,"wifi":true,"ieee802154":true,"sysctl":true,"swap":true,"tmpdir":true,"segv":true}
openat$kvm(0xffffffffffffff9c, &(0x7f0000000040), 0x0, 0x0)
openat$kvm(0xffffffffffffff9c, &(0x7f0000000040), 0x0, 0x0) (async)
r0 = socket$inet6_udp(0xa, 0x2, 0x0)
ioctl$sock_qrtr_TIOCINQ(r0, 0x2, &(0x7f0000003c00))
socket$qrtr(0x2a, 0x2, 0x0) (async)
r1 = socket$qrtr(0x2a, 0x2, 0x0)
sendmsg$qrtr(r1, &(0x7f0000000400)={&(0x7f0000000000)={0x2a, 0xffffffff, 0x7ffd}, 0xc, &(0x7f0000000300)=[{&(0x7f0000000040)="a117674a5bf2", 0x6}, {&(0x7f0000000080)="57285c0525501fe47f6357c672e7d121f10c7c02677f1a709958b2ee69c8d54b908bc7bfc9ffea3e086b70fe7f73c52576006f79f9deaf13c0c0c6edab9c5615798069c6660a6fd60d5e43759694c7518dcc5242f14b136bc4225c564a7888a3631fa3b2aae5ecda16d19ad6eda39aac3407e05eae220f6844562642f511fb9afc5c7a2bc616d3774d3d5c036c31f5f08323e8c0da9e083ba4ba93ccb9530bda5ed68e3d6eaf86c9507d", 0xaa}, {&(0x7f0000000140)="a41e8e7ef0e45aaa8a8452dbb9c91e99a29c177c49c71c729efd361e22450799c8210c8f0df21bf622791ca1e95f49eadbb6815d3895558db8fdfd42c9a3e99cf1b16b462176cdf8b4cbfbd32a216da7354a8b5e01256197ceccf425882ce6a52ec90b54c86e20b3ab2a2801cc07341c2449d8f290ed4262edc9adf000f07bd8493b1e447c4585403c8168516656c578b67f", 0x92}, {&(0x7f0000000200)="b37923ac5debe7ea37bd0d2a39ab0ab5cc9654af6aab77d2dc350fc122f203f5104ae3e6dc642b90af551efcad33e6a8227d", 0x32}, {&(0x7f0000000240)="e6a880", 0x3}, {&(0x7f0000000280)="996aba0e717338bb09ac27f8e66b5c2fae56dbabcaa07ba4268c2574b9126a91950694fb400cb9a007f92a1a5cfcf3b2bb5982c9a9253427f7519bd05e15b036314d3c660e2f4e5e7c688716eaed4cb23a4841c66425f90e6ca46079ed66d16a6c9f1ff677869db138879100cc1beb4c8095", 0x72}], 0x6, &(0x7f0000000380)=[{0x70, 0x4cac304a6f4c5f8a, 0x0, "02e0a54d4095fe9bda68036494f349a50b86f1cdbf9f252c418865fa10847bbc1daa2b010bdf2b7ceca7bbc2c5c1a9ac0f02222449c4add235387ed10877667d85a6c3542fae2dd47c970f4d6fe2f34ff848a9ae56a698ef294e"}], 0x70, 0x800}, 0x38)
openat$kvm(0xffffffffffffff9c, &(0x7f0000000040), 0x0, 0x0)
openat$kvm(0xffffffffffffff9c, &(0x7f0000000040), 0x0, 0x0) (async)
ioctl$sock_SIOCGIFINDEX_802154(0xffffffffffffffff, 0x8933, &(0x7f0000000080)={'wpan3\x00', <r2=>0x0})
sendmsg$NL802154_CMD_GET_INTERFACE(0xffffffffffffffff, &(0x7f0000000200)={&(0x7f0000000040)={0x10, 0x0, 0x0, 0x4}, 0xc, &(0x7f00000001c0)={&(0x7f0000000140)={0x74, 0x0, 0x100, 0x70bd26, 0x25dfdbff, {}, [@NL802154_ATTR_IFINDEX={0x8, 0x3, r2}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x300000003}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x200000002}, @NL802154_ATTR_IFINDEX={0x8}, @NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x3}, @NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x3}]}, 0x74}, 0x1, 0x0, 0x0, 0x8040}, 0x1) (async)
ioctl$sock_SIOCGIFINDEX_802154(0xffffffffffffffff, 0x8933, &(0x7f0000000280)={'wpan0\x00', <r3=>0x0})
r4 = syz_init_net_socket$nl_generic(0x10, 0x3, 0x10)
r5 = syz_init_net_socket$nl_generic(0x10, 0x3, 0x10) (async)
r6 = syz_init_net_socket$nl_generic(0x10, 0x3, 0x10)
r7 = syz_genetlink_get_family_id$ieee802154(&(0x7f0000000240), r5)
sendmsg$IEEE802154_LLSEC_ADD_DEVKEY(r6, &(0x7f0000000300)={0x0, 0x0, &(0x7f00000002c0)={&(0x7f0000000640)=ANY=[@ANYBLOB=' \x00\x00\x00', @ANYRES16=r7, @ANYBLOB="010000000000000000002d0000000a0001007770616e31000000f5a17811b90cffe5163f56a6828da37f5c823dcb910cd703d22173cc417d8fde5e22bf925381cdd841fb317aa5f574144bb0d8974de3"], 0x20}}, 0x0)
sendmsg$IEEE802154_LLSEC_DEL_DEVKEY(r4, &(0x7f0000000600)={&(0x7f00000003c0)={0x10, 0x0, 0x0, 0x4000000}, 0xc, &(0x7f00000005c0)={&(0x7f0000000580)={0x20, r7, 0x100, 0x70bd2d, 0x25dfdbfc, {}, [@IEEE802154_ATTR_HW_ADDR={0xc, 0x5, {0xaaaaaaaaaaaa0002}}]}, 0x20}, 0x1, 0x0, 0x0, 0x20040041}, 0x40000)
sendmsg$NL802154_CMD_NEW_SEC_DEVKEY(0xffffffffffffffff, &(0x7f0000000340)={&(0x7f0000000240)={0x10, 0x0, 0x0, 0x2}, 0xc, &(0x7f0000000300)={&(0x7f00000002c0)={0x34, 0x0, 0x100, 0x70bd28, 0x25dfdbff, {}, [@NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x100000001}, @NL802154_ATTR_WPAN_DEV={0xc, 0x6, 0x200000002}, @NL802154_ATTR_IFINDEX={0x8, 0x3, r3}]}, 0x34}, 0x1, 0x0, 0x0, 0x4}, 0x4008040) (async)
sendmsg$IEEE802154_LLSEC_GETPARAMS(0xffffffffffffffff, &(0x7f0000000440)={&(0x7f0000000380), 0xc, &(0x7f0000000400)={&(0x7f0000000480)=ANY=[@ANYBLOB="20000000240a15459c9b8d491f6d6accb65f6bb5add21c530d355d1712badd3b108bda5b95c4038bc8abbacba25c4199727c2bcb1abf3593f38b3f8f6d0c587fb7ed87ae0dc964215be69adb2fd753eb24536fd8e33653cbe133f5fe81e250973874d142164957d6e5b20f1ffe51e8ad83fd401b4840fffcdb414534c5eeb96808dfa208e3bb397618bb93b81995085432bb02caa477dc94a7d6cb9aac44d7d49be4c069bb5c915394160d5d6ff382ac878fedc8a7bc", @ANYRES16=0x0, @ANYBLOB="02002abd7000fcdbdf25240000000a0001007770616e34000000"], 0x20}, 0x1, 0x0, 0x0, 0x10}, 0x20000000) (async)
r8 = openat$ptp0(0xffffffffffffff9c, &(0x7f0000000000), 0x0, 0x0)
ioctl$PTP_ENABLE_PPS(r8, 0x2, 0x0)
r9 = openat$ptp0(0xffffffffffffff9c, &(0x7f0000000000), 0x0, 0x0)
ioctl$PTP_ENABLE_PPS(r9, 0xc0403d08, 0x0) (async)
socket$bt_hidp(0x1f, 0x3, 0x6)
r10 = syz_genetlink_get_family_id$nl802154(&(0x7f0000000700), 0xffffffffffffffff)
ioctl$sock_SIOCGIFINDEX_802154(r6, 0x8933, &(0x7f0000000740)={'wpan4\x00', <r11=>0x0})
sendmsg$NL802154_CMD_NEW_SEC_DEVKEY(r6, &(0x7f0000000a80)={&(0x7f00000006c0)={0x10, 0x0, 0x0, 0x2000000}, 0xc, &(0x7f0000000a40)={&(0x7f0000000780)={0x2ac, r10, 0x400, 0x70bd25, 0x25dfdbff, {}, [@NL802154_ATTR_SEC_DEVKEY={0x15c, 0x2d, 0x0, 0x1, [@NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0102}}, @NL802154_DEVKEY_ATTR_ID={0x6c, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_IMPLICIT={0x2c, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0302}}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x3}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc}, @NL802154_DEV_ADDR_ATTR_MODE={0x8}]}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x40}, @NL802154_KEY_ID_ATTR_INDEX={0x5, 0x2, 0x1}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x1}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x3}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x7}, @NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x5}]}, @NL802154_DEVKEY_ATTR_ID={0xa8, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_IMPLICIT={0x1c, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x3}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0xffff}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6}]}, @NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x7f}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x10, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0102}}]}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x8001}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x1}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x3f}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x50, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0002}}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xaaa2}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x1}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0302}}, @NL802154_DEV_ADDR_ATTR_PAN_ID={0x6, 0x1, 0x3}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0202}}, @NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x3}, @NL802154_DEV_ADDR_ATTR_MODE={0x8}]}]}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0002}}, @NL802154_DEVKEY_ATTR_FRAME_COUNTER={0x8, 0x1, 0x3f}, @NL802154_DEVKEY_ATTR_ID={0x18, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x7fffffff}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x3ff}]}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0302}}]}, @NL802154_ATTR_SEC_DEVKEY={0xc, 0x2d, 0x0, 0x1, [@NL802154_DEVKEY_ATTR_FRAME_COUNTER={0x8, 0x1, 0x1}]}, @NL802154_ATTR_SEC_DEVKEY={0x128, 0x2d, 0x0, 0x1, [@NL802154_DEVKEY_ATTR_ID={0xa8, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_IMPLICIT={0x48, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x1}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xaaa2}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0302}}, @NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x1}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0102}}, @NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x3}, @NL802154_DEV_ADDR_ATTR_EXTENDED={0xc, 0x4, {0xaaaaaaaaaaaa0202}}]}, @NL802154_KEY_ID_ATTR_SOURCE_EXTENDED={0xc, 0x5, 0x4}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x14, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_MODE={0x8}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xfffe}]}, @NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8}, @NL802154_KEY_ID_ATTR_IMPLICIT={0xc, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xfffe}]}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x14, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x1}, @NL802154_DEV_ADDR_ATTR_MODE={0x8, 0x2, 0x3}]}, @NL802154_KEY_ID_ATTR_IMPLICIT={0x14, 0x3, 0x0, 0x1, [@NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xffff}, @NL802154_DEV_ADDR_ATTR_SHORT={0x6, 0x3, 0xffff}]}]}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0202}}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc}, @NL802154_DEVKEY_ATTR_FRAME_COUNTER={0x8, 0x1, 0x8}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0102}}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0202}}, @NL802154_DEVKEY_ATTR_ID={0x1c, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x6}, @NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x3}, @NL802154_KEY_ID_ATTR_SOURCE_SHORT={0x8, 0x4, 0x2}]}, @NL802154_DEVKEY_ATTR_EXTENDED_ADDR={0xc, 0x2, {0xaaaaaaaaaaaa0302}}, @NL802154_DEVKEY_ATTR_ID={0x14, 0x3, 0x0, 0x1, [@NL802154_KEY_ID_ATTR_MODE={0x8, 0x1, 0x2}, @NL802154_KEY_ID_ATTR_MODE={0x8}]}, @NL802154_DEVKEY_ATTR_FRAME_COUNTER={0x8, 0x1, 0x492b}]}, @NL802154_ATTR_IFINDEX={0x8, 0x3, r11}]}, 0x2ac}, 0x1, 0x0, 0x0, 0x40050}, 0x8000) (async)
ioctl$PTP_PIN_GETFUNC2(r8, 0xc0603d0f, &(0x7f00000000c0)={'\x00', 0xff, 0x1, 0x8})
openat$kvm(0xffffffffffffff9c, &(0x7f0000000040), 0x511f03, 0x0) (async)
r12 = openat$ppp(0xffffffffffffff9c, &(0x7f0000001740), 0x0, 0x0)
ioctl$PPPIOCGFLAGS1(r12, 0x8004745a, 0x0) (async, rerun: 32)
ioctl$PPPIOCSMRU1(r12, 0x40047452, &(0x7f00000001c0)=0x2) (async, rerun: 32)
ioctl$sock_bt_hidp_HIDPGETCONNLIST(0xffffffffffffffff, 0x800448d2, &(0x7f0000000200)={0x2, &(0x7f0000000080)=[{@none}, {@fixed}]})
r13 = openat$ptp0(0xffffffffffffff9c, &(0x7f0000000000), 0x0, 0x0)
read$ptp(r13, &(0x7f0000000040)=""/174, 0xae)
